<%- include('../partials/header') %>



<div class="table-responsive">
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">Card Holder</th>
                <th scope="col">App Date</th>
                <th scope="col">Issuer</th>
                <th scope="col">Card Name</th>
                <th scope="col">Credit Pull</th>
                <th scope="col">Annual Fee</th>
                <th scope="col">Next Fee Date</th>
                <th scope="col">Credit Line</th>
                <th scope="col">Account Status</th>
            </tr>
        </thead>
        <tbody>
            <% cards.forEach((card, idx) => { 
                let fullName = '';

                console.log('card.applicant: ', card.applicant);

                users.forEach(user => {
                    console.log('user._id: ', user._id);
                    console.log(user._id === card.applicant);
                    // if(user._id == card.applicant) {
                    //     currentUser = user;
                    //     fullName = `${currentUser.firstName} ${currentUser.lastName}`
                    // }
                    // else {console.log('no match')}
                });
                
                // let fullName = `${currentUser.firstName} ${currentUser.lastName}`
                %>
            <tr>
                <th scope="row"><%= idx+1 %> </th>
                <td><%=  fullName %></td>
                <td><%= card.appDate.toLocaleDateString() %> </td>
                <td><%= card.issuer %> </td>
                <td><%= card.cardName %> </td>
                <td>
                    <% card.creditPull.forEach((pull, idx) => { %>
                    <%  let creditBureaus = ['Experian', 'Equifax', 'Transunion']%>
                    <div><%= pull === null ? '' : creditBureaus[idx]; %> </div>
                    <% }) %>
                </td>
                <td>$<%= card.annualFee %> </td>
                <td><%= card.nextFeeDate.toLocaleDateString() %> </td>
                <td>$<%= card.creditLine %> </td>
                <td>
                    <select name="" id="">
                        <option value="">Active</option>
                        <option value="">Closed</option>
                        <option value="">Downgraded</option>
                    </select>
                </td>
            </tr>

            <% }) %>
        </tbody>
    </table>
</div>


<%- include('../partials/footer') %>