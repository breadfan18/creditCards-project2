<%- include('../partials/header') %>


<h3><%= card.issuer %> <%= card.cardName %> </h3>
<section id="cardDetails">

    <div class="cardDisplayFields">
        <% let currentCardHolder = users.find(user => user._id.equals(card.applicant)); %>
        <% let fullName = `${currentCardHolder.firstName} ${currentCardHolder.lastName}`; %>
        <div>Card Holder: </div>
        <div><%= fullName %> </div>
    </div>
    <div class="cardDisplayFields">
        <div>Application Date:</div>
        <div><%= card.appDate.toLocaleDateString() %></div>
    </div>
    <div class="cardDisplayFields">
        <div>Credit Pull:</div>
        <div>
            <% card.creditPull.forEach((pull, idx) => { %>
            <%  let creditBureaus = ['Experian', 'Equifax', 'Transunion']%>
            <div><%= pull === null ? '' : creditBureaus[idx]; %> </div>
            <% }) %>
        </div>
    </div>
    <div class="cardDisplayFields">
        <div>Bonus Spend: </div>
        <div><%= card.bonusSpend %>
        </div>
    </div>
    <div class="cardDisplayFields">
        <div>Bonus Spend Date: </div>
        <div><%= card.bonusSpendDate.toLocaleDateString() %>
        </div>
    </div>
    <div class="cardDisplayFields">
        <div>Annual Fee: </div>
        <div><%= card.annualFee %>
        </div>
    </div>
    <div class="cardDisplayFields">
        <div>Add a note: </div>
        <form id="add-note-form" action="/cards/<%= card._id %>/notes" method="POST">
            <label>Note:</label>
            <textarea name="note"></textarea>
            <!-- <label>Rating:</label>
            <select name="rating">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select> -->
            <input type="submit" value="Add Note"/>
        </form>
    </div>
</section>

<section id="notes">
    <div>All Notes </div>
    <table class="table table-striped">
        <thead>
          <tr>
            <th>Date</th>
            <th>Note</th>
          </tr>
        </thead>
        <tbody>
            <tr>
              <td>01/01/2021</td>
              <td>This card's annual fee is due on 10/21/2021</td>
            </tr>
        </tbody>
      </table>
</section>



<%- include('../partials/footer') %>